namespace MOM.StartUpServices
{
    using MOM.ActiveMQ;
    using MOM.ActiveMQ.Student;
    using MOM.SandBox.HealthCheckAPI;
    using System;
    using System.Threading;

    public class ProgramInitiater
    {
        // Consumers
        private NMSConsumer teacherConsumer;
        private StudentConsumer studentConsumer;
        // Health Check API
        private HealthCheckController healthController;

        public ProgramInitiater()
        {
            this.studentConsumer = new StudentConsumer();
            this.teacherConsumer = new NMSConsumer();
            this.healthController = new HealthCheckController();
        }

        public void StartServices()
        {
            // Health Check
            Thread threadHealthCheck = new Thread(new ThreadStart(this.healthController.Run));
            // Teacher Consumers
            Thread threadTCStart = new Thread(new ThreadStart(this.teacherConsumer.start));
            Thread threadTCKeyCourse = new Thread(new ThreadStart(this.teacherConsumer.keyCourse));
            // Student Consumers
            Thread threadSCStudentKey = new Thread(new ThreadStart(this.studentConsumer.studentKey));
            
            // Starting Threads to manage consumers
            threadHealthCheck.Start();
            threadTCStart.Start();
            threadTCKeyCourse.Start();
            threadSCStudentKey.Start();

            CompanyLogo();
            // Single run thread to check services on start up
            new Thread(new ThreadStart(this.healthController.checkServices)).Start();
        }

        private void CompanyLogo()
        {
            Console.WriteLine(
            "||||||||||||||||||||||||||||||||||||||||||``..``|||||||||||||||||||||``.``|||||||||||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||||`:oydNMMMMMMNmho/`|||||||||./shmMMMMMMMNdy+-|||||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||/hNMMmyo+/::/+oydNMMd+`|||.omMMNhs+/:::/+shNMMNy-||||||||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||||`+NMMh/`||||||||||||`:sNMNs:hMMmo-|||||||||||||.+dMMd/||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||-mMMs.||||||||||||||||||`+NMMMd:|||||||||||||||||||-hMMh.||||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||/MMm-||||||||||||||||||||||`sm/|||||||||||||||||||||||:NMN-|||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||:MMd`|||||||||||||||||||||||||||||||||||||||||||||||||||.NMm.||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||mMN.|||||||||||||||||||||||||||||||||||||||||||||||||||||/MMy||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||-MMy|||||||||||||||||||||||||||||||||||||||||||||||||||||||mMN`|||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||/MM+|||||||||||||||||||||||||||||||||||||||||||||||||||||||yMM.|||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||:MMs|||||||||||||||||||||||||||||||||||||||||||||||||||||||dMN`|||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||`mMN`|||||||||||||||||||||||||||||||||||||||||||||||||||||-MMh||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||/MMh|||||||||||||||||||||.:+ossso/:`||||||||||||||||||||`mMN.||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||oMMy`|||||||||||||||`/yNMMMNmmmNMMMms:||||||||||||||||`dMM/|||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||oMMd.||||||||||||`oNMMh+-`|||||`-odMMm+|||||||||||||:mMN:||||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||||:mMN+||||||||||:mMNo`|||||||||||||.yMMd.|||||||||`yMMd.|||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||`oMMm/|||||||:MMm.||`:.|||||||--|||:NMN.||||||`oNMN+|||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||.yMMm+`|||`NMm.|||dMN`|||||+MMo|||-MMd||||.sNMNs`||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||||.sNMNs.|/MMo||||`:.|||||||--|||||yMM-|-yMMNo`||||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||||||`+mm/|oMM/||||.`||||||||||:-|||oMM:|sNd/|||||||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||||||||||||:MMs|||.Nm-|||||||`sMo|||dMM.||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||||||||||||||||||dMN:|||.yNdo:::+yNm/|||+MMy|||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||||||||||||||||||.mMN/||||`/oyhys+-||||oMMd`|||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||||||||||||||`yMMd/`|||||||||||`+mMMs|||||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||||||||||||||||-yMMNho/-...-/odMMNs.||||||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||||||||||||||||||`/ymMMMMMMMMNds:`||||||||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||||||||||||||||||||||||||||.-:::-.|||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n" +
            "||||||||||||||||||||+dyohdho:sddh+|||.sdmmds-||-dhohdds:ohddo`||`+hdmdy-|.ohmmdy:||.hhohds`hdoyddh+`|||||||||||||||||||\n" +
            "||||||||||||||||||||dMMd+yMMMy+dMMo|+MMmssmMM+|sMMmosMMMd+yMMd|-NMNsosh::NMNsodMMs|/MMMdy::MMMhshMMm`||||||||||||||||||\n" +
            "||||||||||||||||||||dMM-|`NMm||:MMy|mMM.||.NMN|sMM+||dMM-|`NMN`yMM/|||||hMM:||`NMN./MMy|||:MMy|||sMM+||||||||||||||||||\n" +
            "||||||||||||||||||||dMM-|`NMm||-MMy|hMMo``oMMd|sMM+||dMM.|`NMN`oMMh.`.-`sMMy.`/MMm`/MMs|||:MMm-|.dMM:||||||||||||||||||\n" +
            "||||||||||||||||||||hMN.|`NMd||-MMs|`yMMMMMMy.|oMM/||hMN.||NMm||oNMMMMM+`sNMMMMMh.|:MMo|||:MMMMNMMN/|||||||||||||||||||\n" +
            "||||||||||||||||||||`:.|||.:`|||.:`|||`://:`||||--|||`:.|||.:`|||`-//:`|||`-//:`||||--||||:MMy-//-|||||||||||||||||||||\n" +
            "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||-MMs|||||||||||||||||||||||||\n" +
            "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||.-||||||||||||||||||||||||||");
        }
    }
}
